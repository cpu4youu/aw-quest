import{g as A,S as p,T as M,a as $,Q as m,b as y,q as _,aq as P,e as R,s,u as C,j as e,F as N,R as D,ar as W,f as x,ae as E,p as g,B as I,d as v,i as B,m as L}from"./index-e7c1d9ca.js";import{i as k}from"./index-d17ef97d.js";const z=async t=>await A({options:{code:p.GAME_MC,index_position:1,limit:"10000",scope:p.GAME_MC,table:M.PLAYERS,lower_bound:t,upper_bound:t}}),T=[{label:"prodone",value:0},{label:"prodtwo",value:1},{label:"prodthree",value:2},{label:"prodfour",value:3},{label:"prodfive",value:4},{label:"prodsix",value:5}],G=()=>$({queryKey:[m.MCP_PLAYERS],queryFn:()=>q(),staleTime:1e3*60*60,enabled:!!y.getState().user});async function U(){return _.removeQueries(m.MCP_PLAYERS),await _.invalidateQueries(m.MCP_PLAYERS)}async function q(){const t=y.getState().user;if(!t)return null;try{const i=await z(t.name);return i?F(i):null}catch(i){return console.log(i),null}}async function F(t){var l,c;const i=(c=(l=t==null?void 0:t[0])==null?void 0:l.buildings)==null?void 0:c.sort((r,d)=>T.findIndex(a=>a.label===r.buildingid)-T.findIndex(a=>a.label===d.buildingid)),{getAssetByAssetId:n}=P,u=await Promise.all(i.map(async r=>({...r,staked_asset_ids:await Promise.all(r.staked_asset_ids.map(async d=>{var f;const a=await n(d);return{...a,img:`https://ipfs.alienworlds.io/ipfs/${(f=a==null?void 0:a.data)==null?void 0:f.img}`}}))})));return{...t[0],buildings:u}}const Y=R({"0%":{backgroundPosition:"0% 0%"},"100%":{backgroundPosition:"-135% 0%"}}),Q=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%","@sm":{padding:"0 15px"}}),H=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),K=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),V=s("div",{d:"flex",align:"center",justify:"center",direction:"column",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),J=s("h2",{d:"flex",align:"center",justify:"center",my:"40px",textAlign:"center",color:"$white500",fs:"30px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),Z=s("div",{d:"flex",align:"flex-start",justify:"center",gap:"0px",padding:"50px",bg:"rgba(0, 0, 0, 0.26)",w:"100%",img:{width:"100%",maxW:"510px"},"@sm":{flexWrap:"wrap"}}),X=s("div",{d:"flex",align:"center",justify:"center",direction:"column",gap:"0px",w:"100%",button:{h:"50px",w:"300px",div:{fs:"18px",border:"none"}},"@sm":{mt:"20px"}}),ee=s("div",{d:"flex",align:"center",justify:"center",position:"relative",w:"100%",maxW:"400px",mb:"30px",color:"$white500",fs:"30px",fw:"bold",ff:"$heading",textAlign:"center",gap:"10px"}),te=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",ff:"$body",gap:"10px"}),ne=s("div",{d:"flex",align:"center",justify:"center",mb:"30px",w:"100%",maxW:"550px",textAlign:"center",color:"$white500",fs:"18px",fw:"bold",ff:"$body",gap:"10px"});s("div",{mt:"10px",w:"100%",height:"200px",background:"linear-gradient( -90deg, rgba(3, 16, 32, 0.40), rgba(3, 16, 32, 0.75) ,rgba(3, 16, 32, 0.40))",br:"10px",backgroundSize:"400% 400%",animation:`${Y} 1.2s ease-in-out infinite`});const se=async()=>await A({options:{code:p.GAME_MC,index_position:1,limit:"10000",scope:p.GAME_MC,table:M.SEASON}}),ie=()=>$({queryKey:[m.SEASON],queryFn:()=>ae(),staleTime:1e3*60*60});async function ae(){try{const t=await se();return t||null}catch(t){return console.log(t),null}}async function re(t){const{executeTransaction:i}=C(),n=oe(t);return!!await i(n)}function oe(t){return{actions:[{account:p.GAME_MC,name:"regplayer",authorization:[{actor:t.name,permission:t.requestPermission}],data:{wallet:t.name}}]}}const le=s("div",{d:"flex",align:"center",justify:"flex-start",direction:"column",w:"100%",h:"calc(100vh - 165px)","@sm":{padding:"0 15px"}}),ce=s("div",{d:"flex",align:"center",justify:"center",direction:"column",position:"relative",h:"165px",w:"100%",zIndex:1,img:{zIndex:-1,position:"absolute",h:"165px",w:"100%",objectFit:"cover",inset:0}}),de=s("h2",{d:"flex",align:"center",justify:"center",color:"$white500",fs:"40px",ff:"$heading",textShadow:"0px 4px 4px rgba(0, 0, 0, 0.5)",w:"100%","@sm":{fs:"24px"}}),ue=s("div",{d:"flex",align:"center",justify:"center",direction:"column",margin:"auto",w:"100%",maxW:"1190px","@md":{d:"flex",flexWrap:"wrap"}}),S=()=>e.jsxs(le,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsx(ue,{children:e.jsx(N,{size:"lg",colorSchema:"light"})})]}),xe=D.lazy(()=>W(()=>import("./index-63f5bdd0.js").then(t=>t.i),["assets/index-63f5bdd0.js","assets/index-e7c1d9ca.js","assets/index-55fec1ff.css","assets/index-55521862.js","assets/index-9830f3e6.js","assets/index-a4466917.js"])),pe=()=>{const{data:t,isLoading:i}=G(),{data:n}=ie(),u=y(o=>o.user),[l,c]=x.useState({title:"",nextSeason:e.jsx("br",{}),disabled:!1}),[r,d]=x.useState(!1);function a(){var o,j;if(n!=null&&n[0]){if(E(new Date(g),{start:new Date(n[0].season_start),end:new Date(n[0].season_end)})){const{days:b,hours:h,minutes:w,seconds:O}=v(new Date((o=n==null?void 0:n[0])==null?void 0:o.season_end));c({title:`SEASON ENDS IN ${b} DAYS ${h} HOURS ${w} MINUTES ${O} SECONDS`,nextSeason:e.jsx("br",{}),disabled:!1});return}if(B(new Date(g),new Date(n[0].season_end))){c({title:"WE ARE WRAPPING UP THE PREVIOUS SEASONRETURNING NFTS, SENDING PRIZES, ....",nextSeason:e.jsx("br",{}),disabled:!0});return}if(k(new Date(g),new Date(n[0].season_start))){const{days:b,hours:h,minutes:w}=v(new Date((j=n==null?void 0:n[0])==null?void 0:j.season_start));c({title:"NEW SEASON STARTING SOON",nextSeason:`Next season starting in ${b} days ${h} hours and ${w} minutes`,disabled:!0});return}}}async function f(){if(u){d(!0);try{await re(u)&&(await L(6e3),U())}catch(o){console.log(o)}finally{d(!1)}}}return x.useEffect(()=>{a()},[n]),i?e.jsx(S,{}):t&&n&&E(new Date(g),{start:new Date(n[0].season_start),end:new Date(n[0].season_end)})?e.jsx(x.Suspense,{fallback:e.jsx(S,{}),children:e.jsx(xe,{season:n[0]})}):e.jsx(x.Suspense,{fallback:e.jsx(S,{}),children:e.jsxs(Q,{children:[e.jsxs(H,{children:[e.jsx(K,{children:"Outpost Builder"}),e.jsx("img",{src:"/assets/background/bg-mcp-builder.jpeg",alt:""})]}),e.jsxs(V,{children:[e.jsx(J,{children:l.title}),e.jsxs(Z,{children:[e.jsx("img",{src:"/assets/mcp/mcp-builder.png",alt:""}),e.jsxs(X,{children:[e.jsxs(ee,{children:["WELCOME TO ",e.jsx("br",{})," OUTPOST BUILDER"]}),e.jsxs(te,{children:["Mission Control needs YOU to help gain more resources. Build an outpost on a remote planet in this seasonal idle building game. Ramp up your production and deliver resources to Mission Control in exchange for McPoints.",e.jsx("br",{})," ",e.jsx("br",{}),"Who will manage to to deliver the most resources to Mission Control? Who will take up the challenge for the top of the leaderboard this season?",e.jsx("br",{})," ",e.jsx("br",{}),"Ready? Then what are you waiting for?"]}),e.jsx(ne,{children:l.nextSeason}),e.jsx(I,{isLoading:r,color:"eleventh",disabled:r||l.disabled,rounded:!1,onClick:f,children:"START NOW !"})]})]})]})]})})},me=Object.freeze(Object.defineProperty({__proto__:null,default:pe},Symbol.toStringTag,{value:"Module"}));export{S as L,ie as a,T as b,me as i,U as o,G as u};
